# 强制启用 HEVC 解码

为 Microsoft Edge 强制启用 HEVC (H.265) 视频播放支持。

## 功能

- 强制启用 HEVC 视频播放
- **可切换的开关**：通过扩展图标启用/禁用 HEVC 支持
- 自动拦截浏览器兼容性检查
- 零配置，开箱即用

## 安装

1. 打开 `edge://extensions/`
2. 启用右上角的 **开发者模式**
3. 点击 **加载解包的扩展**
4. 选择本项目文件夹

## 测试扩展

**方法 1：使用测试页面**
1. 打开项目中的 `test.html` 文件
2. 安装扩展前：所有项显示 "✗ 不支持"
3. 安装扩展后：刷新页面，所有项显示 "✓ 支持"
4. 测试开关功能：
   - 点击扩展图标，关闭开关
   - 刷新 test.html，应显示 "✗ 不支持"
   - 重新开启开关，刷新后恢复 "✓ 支持"

**方法 2：浏览器控制台测试**
1. 按 F12 打开开发者工具
2. 在 Console 中输入：
   ```javascript
   document.createElement('video').canPlayType('video/mp4; codecs="hev1"')
   ```
3. 安装扩展前返回 `""`，安装后返回 `"maybe"`

**方法 3：实际视频测试**
- 访问支持 HEVC 的媒体网站（如 Plex、Emby）
- 扩展会防止服务器进行不必要的转码

## 使用

### 基本使用
- 安装后默认自动启用 HEVC 支持
- 播放视频时无需任何操作

### 开关控制
- **启用/禁用**：点击浏览器工具栏的扩展图标，使用开关切换
- **启用状态**：所有网站的 HEVC 视频会被识别为"支持"
- **禁用状态**：恢复浏览器原生检测行为
- **切换后**：需要刷新页面使设置生效

### 注意事项
- 如果视频播放有声音无画面，说明系统不支持 HEVC 硬件解码
- 前往 Microsoft Store 安装 HEVC 扩展：`ms-windows-store://pdp/?ProductId=9n4wgh0z6vhq`

## 工作原理

1. 拦截 `HTMLMediaElement.canPlayType()` 
2. 对 HEVC 编解码器返回"支持"
3. 实际解码由系统硬件完成

## 常见问题

**Q: 为什么视频还是黑屏？**
- 你的硬件可能不支持 HEVC 解码
- 需要安装 Microsoft Store 的 HEVC 扩展
- 清除缓存并重启 Edge

**Q: 开关切换后没有效果？**
- 切换开关后需要刷新网页
- 对于已加载的视频，可能需要重新加载视频

**Q: 对性能有影响吗？**
- 没有，扩展只拦截兼容性检查
- 实际解码由系统硬件完成

**Q: 为什么有些网站还是不能播放 HEVC？**
- 确保扩展开关处于"启用"状态
- 某些网站可能使用其他检测方式

## 许可证

MIT
